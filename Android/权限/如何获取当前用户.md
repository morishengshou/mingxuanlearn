最简单、通用（本应用所在用户）
- 直接拿当前进程所属用户的 userId：
```java
int userId = android.os.UserHandle.myUserId();              // API 17+
```
- 等价写法（先取 UID 再拆出 userId）：
```java
int userId = android.os.UserHandle.getUserId(android.os.Process.myUid());
```
- 如需 UserHandle：
```java
android.os.UserHandle handle = android.os.Process.myUserHandle();
```

区分“本应用所在用户”与“前台（当前活动）用户”
- 上面方法得到的是“本应用运行所在的用户”（例如 u0 或 u10）。
- 如果你是系统/特权应用，并想获取“当前前台用户”的 userId，可用 @SystemApi（需签名权限，如 INTERACT_ACROSS_USERS）：
```java
// 需使用 system SDK 或相应隐藏 API 豁免
int currentForegroundUserId = android.app.ActivityManager.getCurrentUser(); // @SystemApi
```

备注
- 在多用户/工作资料场景下，“前台用户”和“本进程所属用户”可能不同。大多数应用只需要 UserHandle.myUserId() 即可。